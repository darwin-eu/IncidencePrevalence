<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="IncidencePrevalence">
<title>Calculating incidence • IncidencePrevalence</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculating incidence">
<meta property="og:description" content="IncidencePrevalence">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">IncidencePrevalence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a01_Introduction_to_IncidencePrevalence.html">Introduction to IncidencePrevalence</a>
    <a class="dropdown-item" href="../articles/a02_Creating_denominator_populations.html">Creating denominator cohorts</a>
    <a class="dropdown-item" href="../articles/a03_Creating_target_denominator_populations.html">Creating target denominator populations</a>
    <a class="dropdown-item" href="../articles/a04_Calculating_prevalence.html">Calculating prevalence</a>
    <a class="dropdown-item" href="../articles/a05_Calculating_incidence.html">Calculating incidence</a>
    <a class="dropdown-item" href="../articles/a06_Plotting_options.html">Plotting options</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculating incidence</h1>
            
      
      
      <div class="d-none name"><code>a05_Calculating_incidence.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Incidence rates describe the rate at which new events occur in a
population, with the denominator the person-time at risk of the event
during this period. In the previous vignettes we have seen how we can
identify a set of denominator and outcome cohorts. Incidence rates can
then be calculated using time contributed from these denominator cohorts
up to their entry into an outcome cohort.</p>
<p>There are a number of options to consider when calculating incidence
rates. This package accommodates two main parameters, including:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Outcome washout</strong>: The number of days used for a
‘washout’ period between the end of one outcome ending and an individual
starting to contribute time at risk again.</li>
<li>
<strong>Repeated events</strong>: Whether individuals are able to
contribute multiple events during the study period or if they will only
contribute time up to their first event during the study period.</li>
</ol>
<div class="section level4">
<h4 id="no-washout-no-repetitive-events">No washout, no repetitive events<a class="anchor" aria-label="anchor" href="#no-washout-no-repetitive-events"></a>
</h4>
<p>In this example there is no outcome washout specified and repetitive
events are not allowed, so individuals contribute time up to their first
event during the study period.
<img src="inc_no_rep_no_washout.png" width="80%"></p>
</div>
<div class="section level4">
<h4 id="washout-all-history-no-repetitive-events">Washout all history, no repetitive events<a class="anchor" aria-label="anchor" href="#washout-all-history-no-repetitive-events"></a>
</h4>
<p>In this example the outcome washout is all history and repetitive
events are not allowed. As before individuals contribute time up to
their first event during the study period, but having an outcome prior
to the study period (such as person “3”) means that no time at risk is
contributed.</p>
<p><img src="inc_no_rep_washout_all.png" width="80%"></p>
</div>
<div class="section level4">
<h4 id="some-washout-no-repetitive-events">Some washout, no repetitive events<a class="anchor" aria-label="anchor" href="#some-washout-no-repetitive-events"></a>
</h4>
<p>In this example there is some amount of outcome washout and
repetitive events are not allowed. As before individuals contribute time
up to their first event during the study period, but having an outcome
prior to the study period (such as person “3”) means that time at risk
is only contributed once sufficient time has passed for the outcome
washout criteria to have been satisfied.</p>
<p><img src="inc_no_rep_some_washout.png" width="80%"></p>
</div>
<div class="section level4">
<h4 id="some-washout-repetitive-events">Some washout, repetitive events<a class="anchor" aria-label="anchor" href="#some-washout-repetitive-events"></a>
</h4>
<p>Now repetitive events are allowed with some amount of outcome washout
specified. So individuals contribute time up to their first event during
the study period, and then after passing the outcome washout requirement
they begin to contribute time at risk again.</p>
<p><img src="inc_rep_some_washout.png" width="80%"></p>
</div>
</div>
<div class="section level2">
<h2 id="outcome-definition">Outcome definition<a class="anchor" aria-label="anchor" href="#outcome-definition"></a>
</h2>
<p>Outcome cohorts are defined externally. When creating outcome cohorts
for estimating incidence, the most important recommendations for
defining an outcome cohort for calculating incidence are:</p>
<ol style="list-style-type: decimal">
<li>Do not restrict outcome cohorts to first events only. This will
impact the ability to exclude participants (as they can be excluded
based on the prior latest event) and to capture more than one event per
person (which is an option allowed in the package).</li>
<li>Set an appropriate cohort exit strategy. If we want to consider
multiple events per person, the duration of these events will be of
importance, as we are not going to capture subsequent events if prior
events have not yet been concluded. In addition, outcome washouts will
be implemented relative to cohort exit from any previous event.</li>
<li>Do not add further restrictions on sex, age and prior history
requirements. These can be specified when identifying the denominator
population with the <code><a href="../reference/generateDenominatorCohortSet.html">generateDenominatorCohortSet()</a></code>
function.</li>
</ol>
</div>
<div class="section level2">
<h2 id="using-estimateincidence">Using estimateIncidence()<a class="anchor" aria-label="anchor" href="#using-estimateincidence"></a>
</h2>
<p><code><a href="../reference/estimateIncidence.html">estimateIncidence()</a></code> is the function we use to estimate
incidence rates. To demonstrate its use, let´s load the
IncidencePrevalence package (along with a couple of packages to help for
subsequent plots) and generate 50,000 example patients using the
<code><a href="../reference/mockIncidencePrevalenceRef.html">mockIncidencePrevalenceRef()</a></code> function, from whom we´ll
create a denominator population without adding any restrictions other
than a study period. In this example we’ll use permanent tables (rather
than temporary tables which would be used by default).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/IncidencePrevalence/">IncidencePrevalence</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mockIncidencePrevalenceRef.html">mockIncidencePrevalenceRef</a></span><span class="op">(</span></span>
<span>  sampleSize <span class="op">=</span> <span class="fl">20000</span>,</span>
<span>  earliestObservationStartDate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1960-01-01"</span><span class="op">)</span>, </span>
<span>  minOutcomeDays <span class="op">=</span> <span class="fl">365</span>,</span>
<span>  outPre <span class="op">=</span> <span class="fl">0.3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateDenominatorCohortSet.html">generateDenominatorCohortSet</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>, name <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  cohortDateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1990-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2009-12-31"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ageGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="st">"Both"</span>,</span>
<span>  daysPriorObservation <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Creating denominator cohorts</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Cohorts created in 0 min and 3 sec</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">denominator</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 4</span></span>
<span><span class="co">#&gt; Database: DuckDB v1.0.0 [unknown@Linux 6.5.0-1022-azure:R 4.4.1/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ subject_id           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "2", "5", "6", "7", "8", "10", "11", "12", "…</span></span>
<span><span class="co">#&gt; $ cohort_start_date    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1990-04-15, 1990-01-01, 1990-01-01, …</span></span>
<span><span class="co">#&gt; $ cohort_end_date      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-02-23, 1997-04-01, 2007-05-03, 1994-08-25, …</span></span></code></pre></div>
<p>Let´s first calculate incidence rates on a yearly basis, without
allowing repetitive events</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">inc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20</span></span>
<span><span class="co">#&gt; Columns: 29</span></span>
<span><span class="co">#&gt; $ analysis_id                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "1", "1", "1", "1", "1", …</span></span>
<span><span class="co">#&gt; $ n_persons                               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 16385, 16375, 16346, 16333, 16…</span></span>
<span><span class="co">#&gt; $ person_days                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5878409, 5889726, 5904453, 587…</span></span>
<span><span class="co">#&gt; $ n_events                                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 106, 107, 93, 92, 112, 111, 10…</span></span>
<span><span class="co">#&gt; $ incidence_start_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1991-01-01, 1992-…</span></span>
<span><span class="co">#&gt; $ incidence_end_date                      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-12-31, 1991-12-31, 1992-…</span></span>
<span><span class="co">#&gt; $ person_years                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 16094.21, 16125.19, 16165.51, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 658.6221, 663.5580, 575.2988, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys_95CI_lower         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 539.2258, 543.8018, 464.3404, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys_95CI_upper         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 796.5844, 801.8420, 704.7800, …</span></span>
<span><span class="co">#&gt; $ cohort_obscured                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FALSE", "FALSE", "FALSE", "FA…</span></span>
<span><span class="co">#&gt; $ result_obscured                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FALSE", "FALSE", "FALSE", "FA…</span></span>
<span><span class="co">#&gt; $ outcome_cohort_id                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ outcome_cohort_name                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cohort_1", "cohort_1", "cohor…</span></span>
<span><span class="co">#&gt; $ analysis_outcome_washout                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "0", "0", "0", "0", "0", "0", …</span></span>
<span><span class="co">#&gt; $ analysis_repeated_events                <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FA…</span></span>
<span><span class="co">#&gt; $ analysis_interval                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "years", "years", "years", "ye…</span></span>
<span><span class="co">#&gt; $ analysis_complete_database_intervals    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE, TRUE, TRUE, TRUE, TRUE, …</span></span>
<span><span class="co">#&gt; $ denominator_cohort_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ analysis_min_cell_count                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …</span></span>
<span><span class="co">#&gt; $ denominator_cohort_name                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "denominator_cohort_1", "denom…</span></span>
<span><span class="co">#&gt; $ denominator_age_group                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "0 to 150", "0 to 150", "0 to …</span></span>
<span><span class="co">#&gt; $ denominator_sex                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Both", "Both", "Both", "Both"…</span></span>
<span><span class="co">#&gt; $ denominator_days_prior_observation      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">#&gt; $ denominator_start_date                  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1990-01-01, 1990-…</span></span>
<span><span class="co">#&gt; $ denominator_end_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2009-12-31, 2009-12-31, 2009-…</span></span>
<span><span class="co">#&gt; $ denominator_target_cohort_definition_id <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ denominator_target_cohort_name          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "None", "None", "None", "None"…</span></span>
<span><span class="co">#&gt; $ cdm_name                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "mock", "mock", "mock", "mock"…</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotIncidence.html">plotIncidence</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_Calculating_incidence_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>Now with a washout of all prior history while still not allowing
repetitive events. Here we use <code>Inf</code> to specify that we will
use a washout of all prior history for an individual.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">inc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20</span></span>
<span><span class="co">#&gt; Columns: 29</span></span>
<span><span class="co">#&gt; $ analysis_id                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "1", "1", "1", "1", "1", …</span></span>
<span><span class="co">#&gt; $ n_persons                               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 14971, 14984, 14969, 14965, 14…</span></span>
<span><span class="co">#&gt; $ person_days                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5394137, 5393422, 5409034, 539…</span></span>
<span><span class="co">#&gt; $ n_events                                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 106, 107, 93, 92, 112, 111, 10…</span></span>
<span><span class="co">#&gt; $ incidence_start_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1991-01-01, 1992-…</span></span>
<span><span class="co">#&gt; $ incidence_end_date                      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-12-31, 1991-12-31, 1992-…</span></span>
<span><span class="co">#&gt; $ person_years                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14768.34, 14766.38, 14809.13, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 717.7515, 724.6188, 627.9911, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys_95CI_lower         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 587.6361, 593.8426, 506.8698, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys_95CI_upper         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 868.0998, 875.6277, 769.3315, …</span></span>
<span><span class="co">#&gt; $ cohort_obscured                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FALSE", "FALSE", "FALSE", "FA…</span></span>
<span><span class="co">#&gt; $ result_obscured                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FALSE", "FALSE", "FALSE", "FA…</span></span>
<span><span class="co">#&gt; $ outcome_cohort_id                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ outcome_cohort_name                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cohort_1", "cohort_1", "cohor…</span></span>
<span><span class="co">#&gt; $ analysis_outcome_washout                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "inf", "inf", "inf", "inf", "i…</span></span>
<span><span class="co">#&gt; $ analysis_repeated_events                <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FA…</span></span>
<span><span class="co">#&gt; $ analysis_interval                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "years", "years", "years", "ye…</span></span>
<span><span class="co">#&gt; $ analysis_complete_database_intervals    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE, TRUE, TRUE, TRUE, TRUE, …</span></span>
<span><span class="co">#&gt; $ denominator_cohort_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ analysis_min_cell_count                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …</span></span>
<span><span class="co">#&gt; $ denominator_cohort_name                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "denominator_cohort_1", "denom…</span></span>
<span><span class="co">#&gt; $ denominator_age_group                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "0 to 150", "0 to 150", "0 to …</span></span>
<span><span class="co">#&gt; $ denominator_sex                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Both", "Both", "Both", "Both"…</span></span>
<span><span class="co">#&gt; $ denominator_days_prior_observation      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">#&gt; $ denominator_start_date                  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1990-01-01, 1990-…</span></span>
<span><span class="co">#&gt; $ denominator_end_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2009-12-31, 2009-12-31, 2009-…</span></span>
<span><span class="co">#&gt; $ denominator_target_cohort_definition_id <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ denominator_target_cohort_name          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "None", "None", "None", "None"…</span></span>
<span><span class="co">#&gt; $ cdm_name                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "mock", "mock", "mock", "mock"…</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotIncidence.html">plotIncidence</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_Calculating_incidence_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Now we´ll set the washout to 180 days while still not allowing
repetitive events</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">inc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20</span></span>
<span><span class="co">#&gt; Columns: 29</span></span>
<span><span class="co">#&gt; $ analysis_id                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "1", "1", "1", "1", "1", …</span></span>
<span><span class="co">#&gt; $ n_persons                               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 16320, 16375, 16346, 16333, 16…</span></span>
<span><span class="co">#&gt; $ person_days                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5860201, 5884652, 5903877, 587…</span></span>
<span><span class="co">#&gt; $ n_events                                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 106, 107, 93, 92, 112, 111, 10…</span></span>
<span><span class="co">#&gt; $ incidence_start_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1991-01-01, 1992-…</span></span>
<span><span class="co">#&gt; $ incidence_end_date                      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-12-31, 1991-12-31, 1992-…</span></span>
<span><span class="co">#&gt; $ person_years                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 16044.36, 16111.30, 16163.93, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 660.6685, 664.1302, 575.3550, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys_95CI_lower         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 540.9012, 544.2707, 464.3857, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys_95CI_upper         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 799.0595, 802.5333, 704.8487, …</span></span>
<span><span class="co">#&gt; $ cohort_obscured                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FALSE", "FALSE", "FALSE", "FA…</span></span>
<span><span class="co">#&gt; $ result_obscured                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FALSE", "FALSE", "FALSE", "FA…</span></span>
<span><span class="co">#&gt; $ outcome_cohort_id                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ outcome_cohort_name                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cohort_1", "cohort_1", "cohor…</span></span>
<span><span class="co">#&gt; $ analysis_outcome_washout                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "180", "180", "180", "180", "1…</span></span>
<span><span class="co">#&gt; $ analysis_repeated_events                <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FA…</span></span>
<span><span class="co">#&gt; $ analysis_interval                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "years", "years", "years", "ye…</span></span>
<span><span class="co">#&gt; $ analysis_complete_database_intervals    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE, TRUE, TRUE, TRUE, TRUE, …</span></span>
<span><span class="co">#&gt; $ denominator_cohort_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ analysis_min_cell_count                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …</span></span>
<span><span class="co">#&gt; $ denominator_cohort_name                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "denominator_cohort_1", "denom…</span></span>
<span><span class="co">#&gt; $ denominator_age_group                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "0 to 150", "0 to 150", "0 to …</span></span>
<span><span class="co">#&gt; $ denominator_sex                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Both", "Both", "Both", "Both"…</span></span>
<span><span class="co">#&gt; $ denominator_days_prior_observation      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">#&gt; $ denominator_start_date                  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1990-01-01, 1990-…</span></span>
<span><span class="co">#&gt; $ denominator_end_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2009-12-31, 2009-12-31, 2009-…</span></span>
<span><span class="co">#&gt; $ denominator_target_cohort_definition_id <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ denominator_target_cohort_name          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "None", "None", "None", "None"…</span></span>
<span><span class="co">#&gt; $ cdm_name                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "mock", "mock", "mock", "mock"…</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotIncidence.html">plotIncidence</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_Calculating_incidence_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>And finally we´ll set the washout to 180 days and allow repetitive
events</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">inc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20</span></span>
<span><span class="co">#&gt; Columns: 29</span></span>
<span><span class="co">#&gt; $ analysis_id                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "1", "1", "1", "1", "1", …</span></span>
<span><span class="co">#&gt; $ n_persons                               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 16320, 16427, 16504, 16580, 16…</span></span>
<span><span class="co">#&gt; $ person_days                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5860201, 5889980, 5942382, 595…</span></span>
<span><span class="co">#&gt; $ n_events                                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 106, 107, 93, 92, 112, 111, 10…</span></span>
<span><span class="co">#&gt; $ incidence_start_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1991-01-01, 1992-…</span></span>
<span><span class="co">#&gt; $ incidence_end_date                      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-12-31, 1991-12-31, 1992-…</span></span>
<span><span class="co">#&gt; $ person_years                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 16044.36, 16125.89, 16269.36, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 660.6685, 663.5294, 571.6268, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys_95CI_lower         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 540.9012, 543.7784, 461.3766, …</span></span>
<span><span class="co">#&gt; $ incidence_100000_pys_95CI_upper         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 799.0595, 801.8074, 700.2815, …</span></span>
<span><span class="co">#&gt; $ cohort_obscured                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FALSE", "FALSE", "FALSE", "FA…</span></span>
<span><span class="co">#&gt; $ result_obscured                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "FALSE", "FALSE", "FALSE", "FA…</span></span>
<span><span class="co">#&gt; $ outcome_cohort_id                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ outcome_cohort_name                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cohort_1", "cohort_1", "cohor…</span></span>
<span><span class="co">#&gt; $ analysis_outcome_washout                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "180", "180", "180", "180", "1…</span></span>
<span><span class="co">#&gt; $ analysis_repeated_events                <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE, TRUE, TRUE, TRUE, TRUE, …</span></span>
<span><span class="co">#&gt; $ analysis_interval                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "years", "years", "years", "ye…</span></span>
<span><span class="co">#&gt; $ analysis_complete_database_intervals    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE, TRUE, TRUE, TRUE, TRUE, …</span></span>
<span><span class="co">#&gt; $ denominator_cohort_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ analysis_min_cell_count                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …</span></span>
<span><span class="co">#&gt; $ denominator_cohort_name                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "denominator_cohort_1", "denom…</span></span>
<span><span class="co">#&gt; $ denominator_age_group                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "0 to 150", "0 to 150", "0 to …</span></span>
<span><span class="co">#&gt; $ denominator_sex                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Both", "Both", "Both", "Both"…</span></span>
<span><span class="co">#&gt; $ denominator_days_prior_observation      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">#&gt; $ denominator_start_date                  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1990-01-01, 1990-…</span></span>
<span><span class="co">#&gt; $ denominator_end_date                    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2009-12-31, 2009-12-31, 2009-…</span></span>
<span><span class="co">#&gt; $ denominator_target_cohort_definition_id <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ denominator_target_cohort_name          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "None", "None", "None", "None"…</span></span>
<span><span class="co">#&gt; $ cdm_name                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "mock", "mock", "mock", "mock"…</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotIncidence.html">plotIncidence</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_Calculating_incidence_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="section level3">
<h3 id="stratified-analyses">Stratified analyses<a class="anchor" aria-label="anchor" href="#stratified-analyses"></a>
</h3>
<p>As with prevalence. if we specified multiple denominator populations
results will be returned for each. Here for example we define three age
groups for denominator populations and get three sets of estimates back
when estimating incidence</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateDenominatorCohortSet.html">generateDenominatorCohortSet</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>, name <span class="op">=</span> <span class="st">"denominator_age_sex"</span>,</span>
<span>  cohortDateRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1990-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2009-12-31"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ageGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">39</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41</span>, <span class="fl">65</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">66</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="st">"Both"</span>,</span>
<span>  daysPriorObservation <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Creating denominator cohorts</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Cohorts created in 0 min and 5 sec</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator_age_sex"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Getting incidence for analysis 1 of 3</span></span>
<span><span class="co">#&gt; Getting incidence for analysis 2 of 3</span></span>
<span><span class="co">#&gt; Getting incidence for analysis 3 of 3</span></span>
<span><span class="co">#&gt; Overall time taken: 0 mins and 3 secs</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotIncidence.html">plotIncidence</a></span><span class="op">(</span><span class="va">inc</span>, facet <span class="op">=</span> <span class="st">"denominator_age_group"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_Calculating_incidence_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>And again, as with prevalence while we specify time-varying
stratifications when defining our denominator populations, if we have
time-invariant stratifications we can include these at the the
estimation stage.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">denominator</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">denominator</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">subject_id</span><span class="op">)</span>  <span class="op">&lt;</span> <span class="fl">3000</span>, <span class="st">"first"</span>, <span class="st">"second"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Getting incidence for analysis 1 of 1</span></span>
<span><span class="co">#&gt; Overall time taken: 0 mins and 1 secs</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotIncidence.html">plotIncidence</a></span><span class="op">(</span><span class="va">inc</span>, </span>
<span>               facet <span class="op">=</span> <span class="st">"strata_level"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_Calculating_incidence_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">denominator</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">denominator</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>group_1 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">subject_id</span><span class="op">)</span>  <span class="op">&lt;</span> <span class="fl">3000</span>, <span class="st">"first"</span>, <span class="st">"second"</span><span class="op">)</span>,</span>
<span>         group_2 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">subject_id</span><span class="op">)</span>  <span class="op">&lt;</span> <span class="fl">2000</span>, <span class="st">"one"</span>, <span class="st">"two"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_1"</span><span class="op">)</span>, <span class="co"># for just group_1</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_2"</span><span class="op">)</span>, <span class="co"># for just group_2</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_1"</span>, <span class="st">"group_2"</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># for group_1 and group_2  outcomeWashout = 180,</span></span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Getting incidence for analysis 1 of 1</span></span>
<span><span class="co">#&gt; Overall time taken: 0 mins and 2 secs</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotIncidence.html">plotIncidence</a></span><span class="op">(</span><span class="va">inc</span>, </span>
<span>               facet <span class="op">=</span> <span class="st">"strata_level"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 7 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="a05_Calculating_incidence_files/figure-html/unnamed-chunk-12-2.png" width="672"></p>
<div class="section level4">
<h4 id="other-parameters">Other parameters<a class="anchor" aria-label="anchor" href="#other-parameters"></a>
</h4>
<p>In the examples above, we have used calculated incidence rates by
months and years, but it can be also calculated by weeks, months,
quarters, or for the entire study time period. In addition, we can
decide whether to include time intervals that are not fully captured in
the database (e.g., having data up to June for the last study year when
computing yearly incidence rates). By default, incidence will only be
estimated for those intervals where the denominator cohort captures all
the interval (completeDatabaseIntervals=TRUE).</p>
<p>Given that we can set <code><a href="../reference/estimateIncidence.html">estimateIncidence()</a></code> to exclude
individuals based on other parameters (e.g., outcomeWashout), it is
important to note that the denominator population used to compute
incidence rates might differ from the one calculated with
<code><a href="../reference/generateDenominatorCohortSet.html">generateDenominatorCohortSet()</a></code>.</p>
<p>The user can also set the minimum number of events to be reported,
below which results will be obscured. By default, results with &lt;5
occurrences are blinded, but if minCellCount=0, all results will be
reported. 95 % confidence intervals are calculated using the exact
method. We can set verbose=TRUE to report progress as code is running.
By default, no progress is reported (verbose=FALSE).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weeks"</span><span class="op">)</span>,</span>
<span>  completeDatabaseIntervals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Getting incidence for analysis 1 of 1</span></span>
<span><span class="co">#&gt; Overall time taken: 0 mins and 16 secs</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h4>
<p><code><a href="../reference/estimateIncidence.html">estimateIncidence()</a></code> will generate a table with incidence
rates for each of the time intervals studied and for each combination of
the parameters set. Similar to the output obtained by
<code><a href="../reference/generateDenominatorCohortSet.html">generateDenominatorCohortSet()</a></code>, the table generated will
also be associated with attributes such as settings and attrition.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateIncidence.html">estimateIncidence</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  denominatorTable <span class="op">=</span> <span class="st">"denominator"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Years"</span><span class="op">)</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>  repeatedEvents <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnParticipants <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://darwin-eu-dev.github.io/omopgenerics/reference/attrition.html" class="external-link">attrition</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 22 × 24</span></span></span>
<span><span class="co">#&gt;    analysis_id number_records number_subjects reason_id reason  excluded_records</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1           20000          20000                   1 Starti… <span style="color: #BB0000;">NA</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1           20000          20000                   2 Missin… 0               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1           20000          20000                   3 Missin… 0               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1           20000          20000                   4 Cannot… 0               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1           18490          18490                   5 No obs… 1510            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1           18490          18490                   6 Doesn'… 0               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1           18490          18490                   7 Prior … 0               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1           18389          18389                  10 No obs… 101             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1           21901          18389                  11 Starti… <span style="color: #BB0000;">NA</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1           20138          18388                  12 Exclud… 1763            </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 12 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more variables: excluded_subjects &lt;chr&gt;, outcome_cohort_id &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   outcome_cohort_name &lt;chr&gt;, analysis_outcome_washout &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   analysis_repeated_events &lt;lgl&gt;, analysis_interval &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   analysis_complete_database_intervals &lt;lgl&gt;, denominator_cohort_id &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   analysis_min_cell_count &lt;dbl&gt;, denominator_cohort_name &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   denominator_age_group &lt;chr&gt;, denominator_sex &lt;chr&gt;, …</span></span></span></code></pre></div>
<p>As with incidence, if we set returnParticipants as TRUE, we can
identify the individuals who contributed to the analysis by using
`participants(). For example, we can identify those people contributing
to analysis 1 by running</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/participants.html">participants</a></span><span class="op">(</span><span class="va">inc</span>, analysisId <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 4</span></span>
<span><span class="co">#&gt; Database: DuckDB v1.0.0 [unknown@Linux 6.5.0-1022-azure:R 4.4.1/:memory:]</span></span>
<span><span class="co">#&gt; $ subject_id         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "2", "5", "6", "7", "10", "12", "14", "15", "1…</span></span>
<span><span class="co">#&gt; $ cohort_start_date  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-01-01, 1990-04-15, 1990-01-01, 1990-01-01, 19…</span></span>
<span><span class="co">#&gt; $ cohort_end_date    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1990-02-23, 1997-04-01, 2007-05-03, 1994-08-25, 20…</span></span>
<span><span class="co">#&gt; $ outcome_start_date <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span></code></pre></div>
<p>As we;ve used permanent tables for this example, we can drop these
after running our analysis.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/list_tables.html" class="external-link">listTables</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cdm</span>, <span class="st">"cdm_source"</span><span class="op">)</span>, <span class="st">"dbcon"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "denominator"                   "denominator_age_sex"          </span></span>
<span><span class="co">#&gt;  [3] "denominator_age_sex_attrition" "denominator_age_sex_codelist" </span></span>
<span><span class="co">#&gt;  [5] "denominator_age_sex_set"       "denominator_attrition"        </span></span>
<span><span class="co">#&gt;  [7] "denominator_codelist"          "denominator_set"              </span></span>
<span><span class="co">#&gt;  [9] "inc_participants_1"            "observation_period"           </span></span>
<span><span class="co">#&gt; [11] "outcome"                       "outcome_attrition"            </span></span>
<span><span class="co">#&gt; [13] "outcome_codelist"              "outcome_set"                  </span></span>
<span><span class="co">#&gt; [15] "person"                        "target"                       </span></span>
<span><span class="co">#&gt; [17] "target_attrition"              "target_codelist"              </span></span>
<span><span class="co">#&gt; [19] "target_set"</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu-dev.github.io/omopgenerics/reference/dropTable.html" class="external-link">dropTable</a></span><span class="op">(</span>cdm <span class="op">=</span> <span class="va">cdm</span>, name <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"denominator"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu-dev.github.io/omopgenerics/reference/dropTable.html" class="external-link">dropTable</a></span><span class="op">(</span>cdm <span class="op">=</span> <span class="va">cdm</span>, name <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"inc_participants_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/list_tables.html" class="external-link">listTables</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cdm</span>, <span class="st">"cdm_source"</span><span class="op">)</span>, <span class="st">"dbcon"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "observation_period" "outcome"            "outcome_attrition" </span></span>
<span><span class="co">#&gt;  [4] "outcome_codelist"   "outcome_set"        "person"            </span></span>
<span><span class="co">#&gt;  [7] "target"             "target_attrition"   "target_codelist"   </span></span>
<span><span class="co">#&gt; [10] "target_set"</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward Burn, Berta Raventos, Marti Catala.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
